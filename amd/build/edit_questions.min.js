define ("mod_capquiz/edit_questions",["jquery"],function(a){var m={courseModuleId:0};function b(b,c,d){a.ajax({type:"post",url:"action.php",data:b,success:c,error:d})}function c(a,c,d,e){b({action:"set-default-question-rating",id:m.courseModuleId,rating:c},d,e)}function d(a,c,d,e){b({action:"set-question-rating",id:m.courseModuleId,"question-id":a.questionId,rating:c},d,e)}function e(a,b,c){a.data("saving",!0);a.data("dirty",!1);var d=a.next();d.css("color","blue");b(c,a.val(),function(){if(!0===a.data("dirty")){e(a,b,c)}else{d.css("color","green");a.data("dirty",!1);a.data("saving",!1)}},function(){d.css("color","red")})}function f(a){e(a,d,{questionId:a.data("question-id")})}function g(a){e(a,c,null)}function h(b,c){a(document).on("input",b,function(b){var d=a(b.target),e=d.data("saving");if(!0===e){d.data("dirty",!0);return}c(d)})}function i(b){var c=b.index(),d=b.parent().parent(),e=d.find("tr:gt(0)").toArray().sort(function(b,c){var d=a(b).children("td").eq(0),e=a(c).children("td").eq(0);return parseInt(d.text())-parseInt(e.text())});d.append(e);e=d.find("tr:gt(0)").toArray().sort(function(b,d){var e=a(b).children("td").eq(c),f=a(d).children("td").eq(c),g=e.find(".capquiz-sortable-item"),h=f.find(".capquiz-sortable-item"),i=0===g.length?e.html():0===g.val().length?g.html():g.val(),j=0===h.length?f.html():0===h.val().length?h.html():h.val();if(a.isNumeric(i)&&a.isNumeric(j)){return i-j}else{return i.toString().localeCompare(j)}});var f="true"===d.data("asc");d.data("asc",f?"false":"true");var g=f?"fa-arrow-up":"fa-arrow-down";a.each(d.find(".capquiz-sortable"),function(){a(this).find(".fa").remove()});b.prepend("<i class=\"fa "+g+"\"></i>");if(!f){e=e.reverse()}d.append(e);var h=1;d.find("tr:gt(0)").each(function(){a(this).find("td:first-child").html(h);h++})}function j(){a(document).on("click",".capquiz-sortable",function(){i(a(this))});a(".capquiz-sortable-default-asc").each(function(){i(a(this));i(a(this))});a(".capquiz-sortable-default-desc").each(function(){i(a(this))})}function k(){a(".capquiz-question-rating-submit-wrapper button").each(function(b,c){a(c).attr("tabindex",-1)})}function l(){a(".capquiz-add-selected-questions").on("click",function(){var b="";a("#categoryquestions td input[type=checkbox]:checked").each(function(){b+=a(this).attr("name").slice(1)+","});a.post("action.php",{action:"add-question",id:m.courseModuleId,"question-id":b},function(){location.reload()})})}return{initialize:function initialize(a){m.courseModuleId=a;h(".capquiz-question-rating input",f);h(".capquiz-default-question-rating input",g);k();j();l()}}});
//# sourceMappingURL=edit_questions.min.js.map
