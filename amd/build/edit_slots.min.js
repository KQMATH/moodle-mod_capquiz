define("mod_capquiz/edit_slots",["exports","core/ajax"],(function(_exports,_ajax){var obj;Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.setQuestionRating=_exports.init=_exports.SELECTORS=void 0,_ajax=(obj=_ajax)&&obj.__esModule?obj:{default:obj};const SELECTORS={questionRating:".capquiz-question-rating",questionRatingInput:".capquiz-question-rating input",questionRatingSaveButton:".capquiz-question-rating-save",questionRatingResetButton:".capquiz-question-rating-reset"};_exports.SELECTORS=SELECTORS;const setQuestionRating=(courseModuleId,slotId,rating)=>_ajax.default.call([{methodname:"mod_capquiz_set_question_rating",args:{cmid:courseModuleId,slotid:slotId,rating:rating}}])[0];_exports.setQuestionRating=setQuestionRating;_exports.init=courseModuleId=>{window.addEventListener("beforeunload",(()=>{for(const input of document.querySelectorAll(SELECTORS.questionRatingInput))"yes"===input.dataset.dirty&&event.preventDefault()})),document.addEventListener("input",(event=>{const questionRating=event.target.closest(SELECTORS.questionRating);if(questionRating){const input=questionRating.querySelector("input"),dirty=input.dataset.initialValue!==input.value,saveButton=questionRating.querySelector(SELECTORS.questionRatingSaveButton),resetButton=questionRating.querySelector(SELECTORS.questionRatingResetButton);saveButton.classList.toggle("d-none",!dirty),resetButton.classList.toggle("d-none",!dirty),dirty?input.dataset.dirty="yes":input.removeAttribute("data-dirty")}})),document.addEventListener("click",(async event=>{const saveButton=event.target.closest(SELECTORS.questionRatingSaveButton);if(saveButton){const questionRating=event.target.closest(SELECTORS.questionRating),input=questionRating.querySelector(SELECTORS.questionRatingInput),resetButton=questionRating.querySelector(SELECTORS.questionRatingResetButton);saveButton.disabled=!0,resetButton.disabled=!0;const newValue=parseFloat(input.value);await setQuestionRating(courseModuleId,parseInt(input.dataset.slotId),newValue),input.dataset.initialValue=input.value,saveButton.classList.add("d-none"),resetButton.classList.add("d-none"),saveButton.disabled=!1,resetButton.disabled=!1,input.removeAttribute("data-dirty")}const resetButton=event.target.closest(SELECTORS.questionRatingResetButton);if(resetButton){const questionRating=event.target.closest(SELECTORS.questionRating),input=questionRating.querySelector(SELECTORS.questionRatingInput);input.value=input.dataset.initialValue,input.removeAttribute("data-dirty"),questionRating.querySelector(SELECTORS.questionRatingSaveButton).classList.add("d-none"),resetButton.classList.add("d-none")}}))}}));

//# sourceMappingURL=edit_slots.min.js.map