{"version":3,"file":"qbank_modal.min.js","sources":["../src/qbank_modal.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * @module     mod_capquiz\n * @author     Sebastian Gundersen <sebastian@sgundersen.com>\n * @copyright  2024 Norwegian University of Science and Technology (NTNU)\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n\"use strict\";\n\nimport Modal from 'core/modal';\nimport * as ModalEvents from 'core/modal_events';\nimport * as FormChangeChecker from 'core_form/changechecker';\nimport * as Fragment from 'core/fragment';\n\nexport class QuestionBankModal extends Modal {\n\n    /**\n     * @param {Object} modalConfig\n     */\n    configure(modalConfig) {\n        modalConfig.large = true;\n        modalConfig.show = true;\n        this.contextId = modalConfig.contextId;\n        super.configure(modalConfig);\n    }\n\n    /**\n     * Display this modal.\n     *\n     * @returns {Promise}\n     */\n    show() {\n        this.setBody(Fragment.loadFragment('mod_capquiz', 'capquiz_qbank', this.contextId, {\n            querystring: window.location.search,\n        }));\n        return super.show();\n    }\n\n    /**\n     * Register event listeners.\n     */\n    registerEventListeners() {\n        super.registerEventListeners(this);\n        this.getModal().on('click', 'a', event => {\n            const target = event.currentTarget;\n            if (target.closest('td.capquiz_add_question')) {\n                return;\n            }\n            if (target.closest('td.capquiz_preview_question')) {\n                return;\n            }\n            if (target.closest('.sorters')) {\n                return;\n            }\n            event.preventDefault();\n            this.reloadBodyContent(target.getAttribute('search'));\n        });\n        this.getRoot().on(ModalEvents.bodyRendered, () => {\n            FormChangeChecker.disableAllChecks();\n        });\n    }\n}\n\n/**\n * Initialize.\n *\n * @param {number} contextId\n */\nexport const init = contextId => {\n    QuestionBankModal.registerModalType();\n    document.addEventListener('click', async event => {\n        const target = event.target.closest('.menu [data-action=\"questionbank\"]');\n        if (target) {\n            event.preventDefault();\n            await QuestionBankModal.create({\n                contextId: contextId,\n                title: target.dataset.header,\n                addOnPage: target.dataset.addonpage,\n                templateContext: {\n                    hidden: true,\n                },\n                large: true,\n            });\n        }\n    });\n};\n"],"names":["QuestionBankModal","Modal","configure","modalConfig","large","show","contextId","setBody","Fragment","loadFragment","this","querystring","window","location","search","super","registerEventListeners","getModal","on","event","target","currentTarget","closest","preventDefault","reloadBodyContent","getAttribute","getRoot","ModalEvents","bodyRendered","FormChangeChecker","disableAllChecks","registerModalType","document","addEventListener","async","create","title","dataset","header","addOnPage","addonpage","templateContext","hidden"],"mappings":"s7CA6BaA,0BAA0BC,eAKnCC,UAAUC,aACNA,YAAYC,OAAQ,EACpBD,YAAYE,MAAO,OACdC,UAAYH,YAAYG,gBACvBJ,UAAUC,aAQpBE,mBACSE,QAAQC,SAASC,aAAa,cAAe,gBAAiBC,KAAKJ,UAAW,CAC/EK,YAAaC,OAAOC,SAASC,UAE1BC,MAAMV,OAMjBW,+BACUA,uBAAuBN,WACxBO,WAAWC,GAAG,QAAS,KAAKC,cACvBC,OAASD,MAAME,cACjBD,OAAOE,QAAQ,4BAGfF,OAAOE,QAAQ,gCAGfF,OAAOE,QAAQ,cAGnBH,MAAMI,sBACDC,kBAAkBJ,OAAOK,aAAa,oBAE1CC,UAAUR,GAAGS,YAAYC,cAAc,KACxCC,kBAAkBC,kFAUVxB,YAChBN,kBAAkB+B,oBAClBC,SAASC,iBAAiB,SAASC,MAAAA,cACzBd,OAASD,MAAMC,OAAOE,QAAQ,sCAChCF,SACAD,MAAMI,uBACAvB,kBAAkBmC,OAAO,CAC3B7B,UAAWA,UACX8B,MAAOhB,OAAOiB,QAAQC,OACtBC,UAAWnB,OAAOiB,QAAQG,UAC1BC,gBAAiB,CACbC,QAAQ,GAEZtC,OAAO"}